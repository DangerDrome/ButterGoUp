import{r as e,a as t}from"./react-vendor-BjGICc7J.js";import{T as r,B as a}from"./trading-charts-u049q0rn.js";import{A as n,E as i,X as s,C as o,c as l,H as c,P as d,F as u,a as m,L as p,N as h,T as g,B as f,D as b,b as y,d as v,S as x,R as j,e as w,f as N,g as k,h as S,i as D,j as C,k as I,l as F}from"./utils-_a4hcgJP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var M={exports:{}},E={},R=e,V=Symbol.for("react.element"),A=Symbol.for("react.fragment"),T=Object.prototype.hasOwnProperty,U=R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P={key:!0,ref:!0,__self:!0,__source:!0};function z(e,t,r){var a,n={},i=null,s=null;for(a in void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(s=t.ref),t)T.call(t,a)&&!P.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:V,type:e,key:i,ref:s,props:n,_owner:U.current}}E.Fragment=A,E.jsx=z,E.jsxs=z,M.exports=E;var L,Y=M.exports,Z=t;function B(e,t){if(e.length<t)return[];const r=[];for(let a=t-1;a<e.length;a++){let n=0;for(let r=0;r<t;r++)n+=e[a-r].close;r.push({value:n/t,time:e[a].time})}return r}function O(e,t){if(e.length<t)return[];const r=2/(t+1),a=[];let n=0;for(let s=0;s<t;s++)n+=e[s].close;let i=n/t;a.push({value:i,time:e[t-1].time});for(let s=t;s<e.length;s++)i=(e[s].close-i)*r+i,a.push({value:i,time:e[s].time});return a}function G(e,t=20,r=2){if(e.length<t)return[];const a=[];for(let n=t-1;n<e.length;n++){let i=0;for(let r=0;r<t;r++)i+=e[n-r].close;const s=i/t;let o=0;for(let r=0;r<t;r++){const t=e[n-r].close-s;o+=t*t}const l=Math.sqrt(o/t);a.push({upper:s+r*l,middle:s,lower:s-r*l,time:e[n].time})}return a}L=Z.createRoot,Z.hydrateRoot;const W=[{id:"news-001",time:"2024-11-15",title:"Fonterra raises forecast milk price to $9.50/kgMS",description:"Fonterra has raised its 2024/25 season forecast Farmgate Milk Price range to $9.00-$10.00 per kgMS, up from the previous range of $8.25-$9.75 per kgMS.",source:"Fonterra Co-operative Group",url:"https://www.fonterra.com/nz/en/our-stories/media/fonterra-raises-forecast",category:"commodity",impact:"high",relatedIndicators:["milk-farmgate","butter-export","wmp","smp"]},{id:"news-002",time:"2024-10-22",title:"Global dairy prices surge 4.7% at GDT auction",description:"The GDT Price Index rose 4.7%, with whole milk powder up 5.4% to US$3,559/tonne and butter prices climbing 3.2% to US$6,883/tonne.",source:"GlobalDairyTrade",category:"market",impact:"high",relatedIndicators:["butter-export","wmp","smp","amf"]},{id:"news-003",time:"2024-09-18",title:"RBNZ holds OCR at 5.5% amid sticky inflation",description:"The Reserve Bank of New Zealand kept the Official Cash Rate unchanged at 5.5%, citing persistent inflation pressures including rising food prices.",source:"Reserve Bank of New Zealand",category:"economic",impact:"medium",relatedIndicators:["ocr","cpi","nzdusd"]},{id:"news-004",time:"2024-08-05",title:"Butter shortage hits NZ supermarkets",description:"New Zealand consumers face empty butter shelves as strong export demand and limited local supply drive retail prices to record highs above $8 per 500g block.",source:"NZ Herald",category:"market",impact:"high",relatedIndicators:["butter-retail"]},{id:"news-005",time:"2024-07-12",title:"EU-NZ trade deal increases dairy export quotas",description:"The European Union and New Zealand finalize trade agreement, expanding dairy export quotas including a 15% increase for butter exports over 7 years.",source:"Ministry of Foreign Affairs and Trade",category:"regulatory",impact:"medium",relatedIndicators:["butter-export","wmp","smp"]},{id:"news-006",time:"2023-12-15",title:"La Niña weather pattern threatens milk production",description:"NIWA confirms La Niña conditions expected to bring dry conditions to key dairy regions, potentially impacting milk production volumes for 2024 season.",source:"NIWA",category:"general",impact:"medium",relatedIndicators:["milk-farmgate","butter-export","wmp"]},{id:"news-007",time:"2023-10-03",title:"China resumes imports of NZ dairy products",description:"China lifts temporary restrictions on New Zealand dairy imports, boosting demand expectations for whole milk powder and butter in Q4 2023.",source:"Ministry for Primary Industries",category:"market",impact:"high",relatedIndicators:["wmp","butter-export","amf"]},{id:"news-008",time:"2023-08-22",title:"Fonterra posts record annual revenue of $24.7B",description:"Fonterra announces record revenue driven by strong global dairy prices, with butter and milk powder exports leading growth.",source:"Fonterra Annual Report",category:"commodity",impact:"medium",relatedIndicators:["butter-export","wmp","smp","milk-farmgate"]},{id:"news-009",time:"2023-06-14",title:"RBNZ raises OCR to 5.5% to combat inflation",description:"Reserve Bank increases Official Cash Rate by 25 basis points to 5.5%, the highest level since 2008, citing persistent inflation including food prices.",source:"Reserve Bank of New Zealand",category:"economic",impact:"high",relatedIndicators:["ocr","cpi","nzdusd","nzdaud"]},{id:"news-010",time:"2023-04-05",title:"Global dairy demand softens on recession fears",description:"GDT auction sees 7.1% price decline as global buyers reduce purchases amid economic uncertainty, butter prices fall 8.3% to US$5,245/tonne.",source:"GlobalDairyTrade",category:"market",impact:"high",relatedIndicators:["butter-export","wmp","smp"]},{id:"news-011",time:"2022-11-28",title:"Record butter prices as global shortage intensifies",description:"International butter prices hit all-time high of US$7,200/tonne as European production falls and global demand remains strong.",source:"USDA Foreign Agricultural Service",category:"commodity",impact:"high",relatedIndicators:["butter-export","butter-retail"]},{id:"news-012",time:"2022-09-15",title:"Spring milk production exceeds expectations",description:"Favorable weather conditions boost New Zealand spring milk production 4.2% above forecast, easing supply concerns for dairy products.",source:"DairyNZ",category:"commodity",impact:"medium",relatedIndicators:["milk-farmgate","butter-export","wmp","smp"]},{id:"news-013",time:"2022-07-20",title:"Ukraine conflict disrupts global dairy trade",description:"Ongoing conflict in Ukraine affects global dairy supply chains, redirecting trade flows and supporting higher prices for New Zealand exports.",source:"International Dairy Federation",category:"market",impact:"high",relatedIndicators:["butter-export","wmp","smp","amf"]},{id:"news-014",time:"2022-05-10",title:"Fonterra launches sustainability-linked pricing",description:"Fonterra introduces new pricing structure rewarding farmers for meeting sustainability targets, potentially affecting future milk supply costs.",source:"Fonterra Co-operative Group",category:"regulatory",impact:"low",relatedIndicators:["milk-farmgate"]},{id:"news-015",time:"2022-03-02",title:"NZ dollar strengthens on commodity boom",description:"New Zealand dollar reaches 0.69 USD as surging commodity prices, including dairy exports, boost terms of trade.",source:"Reserve Bank of New Zealand",category:"economic",impact:"medium",relatedIndicators:["nzdusd","nzdaud","twi"]},{id:"news-016",time:"2021-12-08",title:"Supply chain crisis impacts dairy packaging",description:"Global shipping delays and packaging shortages affect New Zealand dairy exporters, adding costs and delays to butter and milk powder shipments.",source:"Dairy Companies Association of NZ",category:"market",impact:"medium",relatedIndicators:["butter-export","wmp","smp"]},{id:"news-017",time:"2021-10-19",title:"China dairy demand drives record GDT prices",description:"Strong Chinese buying pushes GDT index up 4.3%, with butter prices reaching US$5,532/tonne amid global supply constraints.",source:"GlobalDairyTrade",category:"market",impact:"high",relatedIndicators:["butter-export","wmp","smp","amf"]},{id:"news-018",time:"2021-08-11",title:"NZ enters COVID-19 lockdown, dairy deemed essential",description:"New Zealand enters nationwide lockdown but dairy processing and exports continue as essential services, maintaining supply chains.",source:"New Zealand Government",category:"general",impact:"low",relatedIndicators:["butter-retail","milk-farmgate"]},{id:"news-019",time:"2021-06-03",title:"Fonterra announces $8.40/kgMS forecast",description:"Fonterra opens 2021/22 season with strong forecast milk price of $7.90-$8.90 per kgMS, reflecting robust global demand.",source:"Fonterra Co-operative Group",category:"commodity",impact:"high",relatedIndicators:["milk-farmgate","butter-export","wmp","smp"]},{id:"news-020",time:"2021-04-14",title:"Environmental regulations tighten for dairy farms",description:"New freshwater regulations come into effect, requiring dairy farmers to reduce nitrogen leaching by 2025, potentially impacting production costs.",source:"Ministry for the Environment",category:"regulatory",impact:"medium",relatedIndicators:["milk-farmgate"]},{id:"news-021",time:"2020-11-25",title:"COVID-19 shifts global dairy consumption patterns",description:"Pandemic drives retail dairy demand up 15% while foodservice sector remains weak, creating volatility in butter and cheese markets.",source:"International Dairy Federation",category:"market",impact:"high",relatedIndicators:["butter-retail","butter-export"]},{id:"news-022",time:"2020-09-08",title:"RBNZ introduces Funding for Lending Programme",description:"Reserve Bank launches new monetary stimulus program to support economy, keeping OCR at record low 0.25% to boost recovery.",source:"Reserve Bank of New Zealand",category:"economic",impact:"high",relatedIndicators:["ocr","nzdusd","nzdaud"]},{id:"news-023",time:"2020-07-01",title:"Dairy prices recover as economies reopen",description:"Global dairy prices rebound from COVID lows, with butter up 23% from April as restaurants and cafes gradually reopen worldwide.",source:"GlobalDairyTrade",category:"market",impact:"medium",relatedIndicators:["butter-export","wmp","smp"]},{id:"news-024",time:"2020-04-22",title:"Dairy exports remain resilient despite lockdowns",description:"New Zealand dairy exports continue flowing to international markets despite domestic lockdown, supporting rural economy.",source:"Ministry for Primary Industries",category:"market",impact:"medium",relatedIndicators:["butter-export","wmp","smp","amf"]},{id:"news-025",time:"2020-02-05",title:"Drought declared in North Island regions",description:"Government declares drought in Northland and parts of Auckland, affecting dairy production and increasing feed costs for farmers.",source:"Ministry for Primary Industries",category:"general",impact:"high",relatedIndicators:["milk-farmgate","butter-export","wmp"]}];const $={high:"#f45171",medium:"#ff9800",low:"#3ecf8e"};async function q(e,t,r){let a=function(e,t){return W.filter(r=>r.time>=e&&r.time<=t)}(e,t);return r&&(a=a.filter(e=>e.relatedIndicators?.includes(r)||!1)),a}function _({newsEvents:t,chart:r}){const[a,i]=e.useState(null),[s,o]=e.useState(null),[l,c]=e.useState(new Map),[d,u]=e.useState(null),[m,p]=e.useState(null),[h,g]=e.useState(null),[f,b]=e.useState(null),[y,v]=e.useState(null),[x,j]=e.useState(null),[w,N]=e.useState(!1),[k,S]=e.useState(null),D=e.useRef(null),C=()=>{i(null),v(null),o(null),u(null),g(null)};e.useLayoutEffect(()=>{let e;const n=()=>{const i=r.timeScale(),s=new Map;if(t.forEach(e=>{const t=i.timeToCoordinate(e.time);null!==t&&s.set(e.id,t)}),c(s),y){const e=s.get(y);if(void 0!==e){if(u(e),a&&D.current){const t=D.current.getBoundingClientRect();o({x:t.left+e,y:t.top})}}else C()}if(x){const e=s.get(x);void 0!==e?p(e):(j(null),p(null),b(null))}e=requestAnimationFrame(n)};return e=requestAnimationFrame(n),()=>{cancelAnimationFrame(e)}},[r,t,y,x,a]);const I=()=>{j(null),p(null),b(null)};return Y.jsxs("div",{ref:D,className:"news-markers-bar",onMouseLeave:()=>{j(null),p(null),b(null)},children:[null!==d&&Y.jsx("div",{className:"news-marker-line selected",style:{left:`${d}px`,borderColor:h||"var(--accent)"}}),null!==m&&d!==m&&Y.jsx("div",{className:"news-marker-line hovered",style:{left:`${m}px`,borderColor:f||"var(--text-secondary)"}}),t.map(e=>{const t=l.get(e.id);if(void 0===t)return null;const r="high"===e.impact?20:16;return Y.jsx("div",{className:"news-marker",style:{left:`${t}px`,marginLeft:`-${r/2}px`},onClick:t=>((e,t)=>{const r=l.get(t.id);if(void 0!==r&&D.current){const e=D.current.getBoundingClientRect();o({x:e.left+r,y:e.top}),i(t),v(t.id),u(r),g($[t.impact])}})(0,e),onMouseEnter:t=>((e,t)=>{const r=l.get(t.id);x!==t.id&&(j(t.id),p(r||null),b($[t.impact]))})(0,e),onMouseLeave:I,title:e.title,children:Y.jsx(n,{size:r,color:$[e.impact]})},e.id)}),a&&s&&null!==d&&Y.jsx(H,{news:a,markerX:d,onClose:C,onOpenModal:e=>{S(e),N(!0)}}),w&&k&&Y.jsx(J,{url:k,onClose:()=>{N(!1),S(null)}})]})}function H({news:t,markerX:r,onClose:a,onOpenModal:n}){const s=e.useRef(null);e.useEffect(()=>{const e=e=>{s.current&&!s.current.contains(e.target)&&a()};return setTimeout(()=>{document.addEventListener("mousedown",e)},100),()=>{document.removeEventListener("mousedown",e)}},[a]);return Y.jsxs("div",{ref:s,className:"news-popover",style:{position:"absolute",left:`${r}px`,bottom:"100%",marginBottom:"40px",transform:"translateX(-50%)"},children:[Y.jsx("div",{className:"news-popover-arrow"}),Y.jsxs("div",{className:"news-popover-content",children:[Y.jsx("h4",{children:t.title}),Y.jsxs("div",{className:"news-popover-meta",children:[Y.jsx("span",{className:"news-date",children:(o=t.time,new Date(o).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"}))}),Y.jsx("span",{className:"news-source",children:t.source})]}),Y.jsx("p",{children:t.description}),t.url&&Y.jsxs("button",{onClick:e=>{e.preventDefault(),n(t.url)},className:"news-link-button",children:[Y.jsx(i,{size:14}),"View source"]})]})]});var o}function J({url:t,onClose:r}){const[a,n]=e.useState(!0),o=e.useRef(null);return e.useEffect(()=>{const e=setTimeout(()=>{n(!1)},500);return()=>clearTimeout(e)},[t]),e.useEffect(()=>{const e=e=>{"Escape"===e.key&&r()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[r]),Y.jsx("div",{className:"news-modal-overlay",onClick:r,children:Y.jsxs("div",{ref:o,className:"news-modal",onClick:e=>e.stopPropagation(),children:[Y.jsxs("div",{className:"news-modal-header",children:[Y.jsx("h3",{children:"Source Content"}),Y.jsx("button",{className:"news-modal-close",onClick:r,children:Y.jsx(s,{size:20})})]}),Y.jsx("div",{className:"news-modal-content",children:a?Y.jsx("div",{className:"news-modal-loading",children:"Loading content..."}):Y.jsx("iframe",{src:t,className:"news-modal-iframe",title:"Source content",sandbox:"allow-same-origin allow-scripts"})}),Y.jsx("div",{className:"news-modal-footer",children:Y.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"news-modal-link",children:[Y.jsx(i,{size:16}),"Open in new tab"]})})]})})}function Q({data:t,activeIndicators:n=[],chartType:i="candlestick",shouldFitContent:s=!1,setShouldFitContent:o,showNews:l=!1,indicatorId:c,compareRanges:d=[]}){const u=e.useRef(null),m=e.useRef(null),p=e.useRef(null),h=e.useRef(new Map),g=e.useRef(new Map),[f,b]=e.useState([]);return e.useEffect(()=>{if(!u.current||m.current)return;const e=r(u.current,{width:u.current.clientWidth,height:u.current.clientHeight,layout:{background:{type:a.Solid,color:"#1f1f1f"},textColor:"#8b8b8b"},grid:{vertLines:{color:"rgba(46, 46, 46, 0.5)"},horzLines:{color:"rgba(46, 46, 46, 0.5)"}},crosshair:{mode:1},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!1},handleScale:{axisPressedMouseMove:{time:!0,price:!0},mouseWheel:!0,pinch:!0},rightPriceScale:{borderVisible:!1,scaleMargins:{top:.1,bottom:.1}},timeScale:{borderVisible:!1,rightBarStaysOnScroll:!1,visible:!0,timeVisible:!0,secondsVisible:!1,barSpacing:3,minBarSpacing:.01,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!0,rightOffset:12,shiftVisibleRangeOnNewBar:!1,allowShiftVisibleRangeOnWhitespaceReplacement:!0}});m.current=e;const t=()=>{u.current&&e&&e.applyOptions({width:u.current.clientWidth,height:u.current.clientHeight})};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),h.current.clear(),e.remove(),m.current=null,p.current=null}},[]),e.useEffect(()=>{if(!m.current||!t||0===t.length)return;let e;switch(p.current&&(m.current.removeSeries(p.current),p.current=null),i){case"line":e=m.current.addLineSeries({color:"#3ecf8e",lineWidth:2}),e.setData(t.map(e=>({time:e.time,value:e.close})));break;case"area":e=m.current.addAreaSeries({topColor:"rgba(62, 207, 142, 0.5)",bottomColor:"rgba(62, 207, 142, 0.1)",lineColor:"#3ecf8e",lineWidth:2}),e.setData(t.map(e=>({time:e.time,value:e.close})));break;case"hlcArea":e=m.current.addAreaSeries({topColor:"rgba(62, 207, 142, 0.5)",bottomColor:"rgba(62, 207, 142, 0.1)",lineColor:"#3ecf8e",lineWidth:2}),e.setData(t.map(e=>({time:e.time,value:e.high})));break;case"columns":e=m.current.addHistogramSeries({color:"#3ecf8e"}),e.setData(t.map((e,r)=>({time:e.time,value:0===r?0:Math.abs(e.close-t[r-1].close),color:e.close>=e.open?"#3ecf8e":"#f45171"})));break;case"baseline":const r=t.reduce((e,t)=>e+t.close,0)/t.length;e=m.current.addBaselineSeries({baseValue:{type:"price",price:r},topLineColor:"#3ecf8e",topFillColor1:"rgba(62, 207, 142, 0.28)",topFillColor2:"rgba(62, 207, 142, 0.05)",bottomLineColor:"#f45171",bottomFillColor1:"rgba(244, 81, 113, 0.05)",bottomFillColor2:"rgba(244, 81, 113, 0.28)",lineWidth:2}),e.setData(t.map(e=>({time:e.time,value:e.close})));break;default:e=m.current.addCandlestickSeries({upColor:"#3ecf8e",downColor:"#f45171",borderVisible:!1,wickUpColor:"#3ecf8e",wickDownColor:"#f45171"}),e.setData(t)}p.current=e},[i,t]),e.useEffect(()=>{if(p.current&&m.current&&t.length)try{switch(i){case"line":case"area":case"baseline":p.current.setData(t.map(e=>({time:e.time,value:e.close})));break;case"hlcArea":p.current.setData(t.map(e=>({time:e.time,value:e.high})));break;case"columns":p.current.setData(t.map((e,r)=>({time:e.time,value:0===r?0:Math.abs(e.close-t[r-1].close),color:e.close>=e.open?"#3ecf8e":"#f45171"})));break;default:p.current.setData(t)}s&&(m.current.timeScale().fitContent(),o&&o(!1))}catch(e){console.error("Error updating chart data:",e)}},[t,i,s,o]),e.useEffect(()=>{if(!m.current||!t.length)return;const e=new Set;h.current.forEach((t,r)=>{"bollinger"===r||"bollinger-upper"===r||"bollinger-lower"===r||"bollinger-fill"===r?n.includes("bollinger")||e.add(r):"stddev"===r||"stddev-upper"===r||"stddev-lower"===r||"stddev-fill"===r?n.includes("stddev")||e.add(r):"bbpercent"===r||r.startsWith("bbpercent-ref")?n.includes("bbpercent")||e.add(r):n.includes(r)||e.add(r)}),e.forEach(e=>{const t=h.current.get(e);t&&m.current&&(m.current.removeSeries(t),h.current.delete(e))}),n.forEach(e=>{const r=h.current.get(e);switch(e){case"bollinger":const a=G(t,20,2);if(h.current.has("bollinger")&&h.current.has("bollinger-upper")&&h.current.has("bollinger-lower")&&h.current.has("bollinger-fill")){const e=h.current.get("bollinger-fill"),t=h.current.get("bollinger"),r=h.current.get("bollinger-upper"),n=h.current.get("bollinger-lower");e?.setData(a.map(e=>({time:e.time,value:e.upper}))),t?.setData(a.map(e=>({time:e.time,value:e.middle}))),r?.setData(a.map(e=>({time:e.time,value:e.upper}))),n?.setData(a.map(e=>({time:e.time,value:e.lower})))}else{if(["bollinger","bollinger-upper","bollinger-lower","bollinger-fill"].forEach(e=>{const t=h.current.get(e);t&&m.current&&(m.current.removeSeries(t),h.current.delete(e))}),!m.current)break;const e=m.current.addAreaSeries({topColor:"rgba(62, 207, 142, 0.05)",bottomColor:"rgba(62, 207, 142, 0.05)",lineColor:"transparent",lineWidth:1,lineVisible:!1,crosshairMarkerVisible:!1}),t=m.current.addLineSeries({color:"rgba(62, 207, 142, 0.4)",lineWidth:1,lineStyle:2}),r=m.current.addLineSeries({color:"rgba(62, 207, 142, 0.8)",lineWidth:1}),n=m.current.addLineSeries({color:"rgba(62, 207, 142, 0.4)",lineWidth:1,lineStyle:2});e.setData(a.map(e=>({time:e.time,value:e.upper}))),t.setData(a.map(e=>({time:e.time,value:e.upper}))),r.setData(a.map(e=>({time:e.time,value:e.middle}))),n.setData(a.map(e=>({time:e.time,value:e.lower}))),h.current.set("bollinger-fill",e),h.current.set("bollinger",r),h.current.set("bollinger-upper",t),h.current.set("bollinger-lower",n)}break;case"sma20":const n=B(t,20);if(!r&&m.current){const t=m.current.addLineSeries({color:"#ff9800",lineWidth:2});t.setData(n.map(e=>({time:e.time,value:e.value}))),h.current.set(e,t)}else r&&r.setData(n.map(e=>({time:e.time,value:e.value})));break;case"sma50":const i=B(t,50);if(!r&&m.current){const t=m.current.addLineSeries({color:"#2196f3",lineWidth:2});t.setData(i.map(e=>({time:e.time,value:e.value}))),h.current.set(e,t)}else r&&r.setData(i.map(e=>({time:e.time,value:e.value})));break;case"ema12":const s=O(t,12);if(!r&&m.current){const t=m.current.addLineSeries({color:"#9c27b0",lineWidth:2});t.setData(s.map(e=>({time:e.time,value:e.value}))),h.current.set(e,t)}else r&&r.setData(s.map(e=>({time:e.time,value:e.value})));break;case"ema26":const o=O(t,26);if(!r&&m.current){const t=m.current.addLineSeries({color:"#e91e63",lineWidth:2});t.setData(o.map(e=>({time:e.time,value:e.value}))),h.current.set(e,t)}else r&&r.setData(o.map(e=>({time:e.time,value:e.value})));break;case"stddev":const l=function(e,t=20,r=2){if(e.length<t)return[];const a=[];for(let n=t-1;n<e.length;n++){const i=e.slice(n-t+1,n+1);let s=0,o=0,l=0,c=0;i.forEach((e,t)=>{const r=t,a=e.close;s+=r,o+=a,l+=r*a,c+=r*r});const d=i.length,u=(d*l-s*o)/(d*c-s*s),m=(o-u*s)/d,p=u*(t-1)+m;let h=0;i.forEach((e,t)=>{const r=u*t+m,a=e.close-r;h+=a*a});const g=Math.sqrt(h/t);a.push({upper:p+r*g,middle:p,lower:p-r*g,time:e[n].time})}return a}(t,20,2);if(h.current.has("stddev")&&h.current.has("stddev-upper")&&h.current.has("stddev-lower")&&h.current.has("stddev-fill")){const e=h.current.get("stddev-fill"),t=h.current.get("stddev"),r=h.current.get("stddev-upper"),a=h.current.get("stddev-lower");e?.setData(l.map(e=>({time:e.time,value:e.upper}))),t?.setData(l.map(e=>({time:e.time,value:e.middle}))),r?.setData(l.map(e=>({time:e.time,value:e.upper}))),a?.setData(l.map(e=>({time:e.time,value:e.lower})))}else{if(["stddev","stddev-upper","stddev-lower","stddev-fill"].forEach(e=>{const t=h.current.get(e);t&&m.current&&(m.current.removeSeries(t),h.current.delete(e))}),!m.current)break;const e=m.current.addAreaSeries({topColor:"rgba(156, 39, 176, 0.05)",bottomColor:"rgba(156, 39, 176, 0.05)",lineColor:"transparent",lineWidth:1,lineVisible:!1,crosshairMarkerVisible:!1}),t=m.current.addLineSeries({color:"rgba(156, 39, 176, 0.6)",lineWidth:1,lineStyle:2}),r=m.current.addLineSeries({color:"rgba(156, 39, 176, 0.9)",lineWidth:2}),a=m.current.addLineSeries({color:"rgba(156, 39, 176, 0.6)",lineWidth:1,lineStyle:2});e.setData(l.map(e=>({time:e.time,value:e.upper}))),t.setData(l.map(e=>({time:e.time,value:e.upper}))),r.setData(l.map(e=>({time:e.time,value:e.middle}))),a.setData(l.map(e=>({time:e.time,value:e.lower}))),h.current.set("stddev-fill",e),h.current.set("stddev",r),h.current.set("stddev-upper",t),h.current.set("stddev-lower",a)}break;case"bbpercent":const c=function(e,t=20,r=2){const a=G(e,t,r);if(0===a.length)return[];const n=[],i=e.length-a.length;for(let s=0;s<a.length;s++){const t=a[s],r=e[i+s].close,o=t.upper-t.lower,l=o>0?(r-t.lower)/o*100:50;n.push({value:l,time:t.time})}return n}(t,20,2);if(!r&&m.current){const t=m.current.addLineSeries({color:"#ff5722",lineWidth:2,priceScaleId:"bbpercent"});if(m.current.priceScale("bbpercent").applyOptions({scaleMargins:{top:.8,bottom:0}}),t.setData(c.map(e=>({time:e.time,value:e.value}))),h.current.set(e,t),!m.current)break;const r=m.current.addLineSeries({color:"rgba(255, 87, 34, 0.3)",lineWidth:1,lineStyle:3,priceScaleId:"bbpercent",crosshairMarkerVisible:!1}),a=m.current.addLineSeries({color:"rgba(255, 87, 34, 0.3)",lineWidth:1,lineStyle:3,priceScaleId:"bbpercent",crosshairMarkerVisible:!1}),n=m.current.addLineSeries({color:"rgba(255, 87, 34, 0.3)",lineWidth:1,lineStyle:3,priceScaleId:"bbpercent",crosshairMarkerVisible:!1}),i=c.map(e=>e.time);r.setData(i.map(e=>({time:e,value:0}))),a.setData(i.map(e=>({time:e,value:50}))),n.setData(i.map(e=>({time:e,value:100}))),h.current.set("bbpercent-ref0",r),h.current.set("bbpercent-ref50",a),h.current.set("bbpercent-ref100",n)}else if(r){r.setData(c.map(e=>({time:e.time,value:e.value})));const e=c.map(e=>e.time);h.current.get("bbpercent-ref0")?.setData(e.map(e=>({time:e,value:0}))),h.current.get("bbpercent-ref50")?.setData(e.map(e=>({time:e,value:50}))),h.current.get("bbpercent-ref100")?.setData(e.map(e=>({time:e,value:100})))}}})},[n,t]),e.useEffect(()=>{if(!m.current||!t.length)return;const e=new Set;g.current.forEach((t,r)=>{d.includes(r)||e.add(r)}),e.forEach(e=>{const t=g.current.get(e);t&&m.current&&(m.current.removeSeries(t),g.current.delete(e))});const r={"1Y":"#f59e0b","2Y":"#3b82f6","3Y":"#a855f7","5Y":"#ec4899",AVG:"#6b7280"};d.forEach(e=>{if(!g.current.has(e)&&m.current){const a=r[e]||"#8b8b8b";let n=[];if("AVG"===e){const e=t.reduce((e,t)=>e+t.close,0)/t.length;n=t.map(t=>({time:t.time,value:e}))}else{const r=parseInt(e);n=t.map((e,t)=>{const a=e.close,n=Math.sin(.1*t+r)*a*.1,i=r*a*.02;return{time:e.time,value:a-i+n}})}const i=m.current.addLineSeries({color:a,lineWidth:2,lineStyle:"AVG"===e?3:0,crosshairMarkerVisible:!1,lastValueVisible:!1,priceLineVisible:!1});i.setData(n),g.current.set(e,i)}})},[d,t]),e.useEffect(()=>{t&&0!==t.length&&async function(){const e=t[0].time,r=t[t.length-1].time,a=await q(e,r,c);b(a)}()},[t,c]),t&&0!==t.length?Y.jsxs("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:[Y.jsx("div",{ref:u,style:{width:"100%",height:"calc(100% - 30px)"}}),l&&f.length>0&&m.current&&Y.jsx(_,{newsEvents:f,chart:m.current})]}):Y.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#8b8b8b"},children:"Loading chart data..."})}const X=[{name:"SYD",market:"ASX",openTime:"10:00",closeTime:"16:00"},{name:"TKY",market:"JPX",openTime:"09:00",closeTime:"15:00"},{name:"LON",market:"LSE",openTime:"08:00",closeTime:"16:30"},{name:"NYC",market:"NYSE",openTime:"09:30",closeTime:"16:00"}];function K(){const[t,r]=e.useState(new Date);e.useEffect(()=>{const e=setInterval(()=>{r(new Date)},1e3);return()=>clearInterval(e)},[]);const a=e=>{switch(e){case"ASX":return"Australia/Sydney";case"JPX":return"Asia/Tokyo";case"LSE":return"Europe/London";case"NYSE":return"America/New_York";default:return"Pacific/Auckland"}};return Y.jsxs("div",{className:"market-status-compact",children:[Y.jsxs("div",{className:"nz-time-compact",children:[Y.jsx("span",{className:"time-compact",children:(n=t,n.toLocaleString("en-NZ",{timeZone:"Pacific/Auckland",hour:"2-digit",minute:"2-digit",hour12:!1}))}),Y.jsx("span",{className:"timezone-compact",children:"NZDT"})]}),Y.jsx("div",{className:"markets-compact",children:X.map(e=>{const t=(e=>{const t=new Date,r=t.toLocaleString("en-US",{timeZone:a(e.market),hour:"2-digit",minute:"2-digit",hour12:!1}),[n,i]=e.openTime.split(":").map(Number),[s,o]=e.closeTime.split(":").map(Number),[l,c]=r.split(":").map(Number),d=60*l+c,u=60*n+i,m=60*s+o,p=t.getDay();return 0!==p&&6!==p&&d>=u&&d<m})(e);return Y.jsxs("div",{className:"market-compact "+(t?"open":""),children:[Y.jsx(o,{size:6,fill:t?"#3ecf8e":"#f45171",color:t?"#3ecf8e":"#f45171"}),Y.jsx("span",{children:e.name})]},e.name)})})]});var n}var ee={};function te(e,t){let r;try{r=e()}catch(a){return}return{getItem:e=>{var t;const a=e=>null===e?null:JSON.parse(e,void 0),n=null!=(t=r.getItem(e))?t:null;return n instanceof Promise?n.then(a):a(n)},setItem:(e,t)=>r.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>r.removeItem(e)}}const re=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then:e=>re(e)(r),catch(e){return this}}}catch(r){return{then(e){return this},catch:e=>re(e)(r)}}},ae=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?("production"!==(ee?"production":void 0)&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),((e,t)=>(r,a,n)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},s=!1;const o=new Set,l=new Set;let c;try{c=i.getStorage()}catch(f){}if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...e)},a,n);const d=re(i.serialize),u=()=>{const e=i.partialize({...a()});let t;const r=d({state:e,version:i.version}).then(e=>c.setItem(i.name,e)).catch(e=>{t=e});if(t)throw t;return r},m=n.setState;n.setState=(e,t)=>{m(e,t),u()};const p=e((...e)=>{r(...e),u()},a,n);let h;const g=()=>{var e;if(!c)return;s=!1,o.forEach(e=>e(a()));const t=(null==(e=i.onRehydrateStorage)?void 0:e.call(i,a()))||void 0;return re(c.getItem.bind(c))(i.name).then(e=>{if(e)return i.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return e.state;if(i.migrate)return i.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}}).then(e=>{var t;return h=i.merge(e,null!=(t=a())?t:p),r(h,!0),u()}).then(()=>{null==t||t(h,void 0),s=!0,l.forEach(e=>e(h))}).catch(e=>{null==t||t(void 0,e)})};return n.persist={setOptions:e=>{i={...i,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>s,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},g(),h||p})(e,t)):((e,t)=>(r,a,n)=>{let i={storage:te(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},s=!1;const o=new Set,l=new Set;let c=i.storage;if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...e)},a,n);const d=()=>{const e=i.partialize({...a()});return c.setItem(i.name,{state:e,version:i.version})},u=n.setState;n.setState=(e,t)=>{u(e,t),d()};const m=e((...e)=>{r(...e),d()},a,n);let p;n.getInitialState=()=>m;const h=()=>{var e,t;if(!c)return;s=!1,o.forEach(e=>{var t;return e(null!=(t=a())?t:m)});const n=(null==(t=i.onRehydrateStorage)?void 0:t.call(i,null!=(e=a())?e:m))||void 0;return re(c.getItem.bind(c))(i.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return e.state;if(i.migrate)return i.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}}).then(e=>{var t;return p=i.merge(e,null!=(t=a())?t:m),r(p,!0),d()}).then(()=>{null==n||n(p,void 0),p=a(),s=!0,l.forEach(e=>e(p))}).catch(e=>{null==n||n(void 0,e)})};return n.persist={setOptions:e=>{i={...i,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>h(),hasHydrated:()=>s,onHydrate:e=>(o.add(e),()=>{o.delete(e)}),onFinishHydration:e=>(l.add(e),()=>{l.delete(e)})},i.skipHydration||h(),p||m})(e,t),ne=l()(ae((e,t)=>({indicators:[],selectedId:"butter-retail",timeRange:"10Y",categoryFilter:"all",alerts:[],addIndicator:t=>e(e=>e.indicators.some(e=>e.id===t.id)?e:{indicators:[...e.indicators,t]}),removeIndicator:t=>e(e=>({indicators:e.indicators.filter(e=>e.id!==t),selectedId:e.selectedId===t?null:e.selectedId})),updateIndicator:(t,r)=>e(e=>({indicators:e.indicators.map(e=>{if(e.id!==t)return e;const a=(r.currentValue??e.currentValue)-e.currentValue,n=0!==e.currentValue?a/e.currentValue*100:0;return{...e,...r,change:r.change??a,changePercent:r.changePercent??n,lastUpdated:new Date}})})),selectIndicator:t=>e({selectedId:t}),setTimeRange:t=>e({timeRange:t}),setCategoryFilter:t=>e({categoryFilter:t}),addAlert:t=>e(e=>({alerts:[...e.alerts,t]})),removeAlert:t=>e(e=>({alerts:e.alerts.filter(e=>e.id!==t)})),updateAlert:(t,r)=>e(e=>({alerts:e.alerts.map(e=>e.id===t?{...e,...r}:e)})),getFilteredIndicators:()=>{const e=t();return"all"===e.categoryFilter?e.indicators:e.indicators.filter(t=>t.category===e.categoryFilter)}}),{name:"buttergoup-storage",partialize:e=>({indicators:e.indicators.map(e=>({...e,data:[]})),alerts:e.alerts,timeRange:e.timeRange,selectedId:e.selectedId,categoryFilter:e.categoryFilter})}));function ie(e,t=.02,r=3650){const a=[];let n=e;const i=[n];for(let l=1;l<r;l++){n*=1-.01*(n*(t+Math.random()*t*.5)*(Math.random()>.5?1:-1)),e<0?i.unshift(n):i.unshift(Math.max(n,.2*e))}const s=new Date;s.setDate(s.getDate()-r+1),console.log(`[generateMockPrices] Start date: ${s.toISOString()}`);for(let l=0;l<r;l++){const e=new Date(s);e.setDate(e.getDate()+l);const r=i[l],n=.3*t,o=0===l?r:i[l-1],c=i[l],d=Math.max(o,c)*(1+Math.random()*n),u=Math.min(o,c)*(1-Math.random()*n);a.push({time:e.toISOString().split("T")[0],open:Math.round(1e4*o)/1e4,high:Math.round(1e4*d)/1e4,low:Math.round(1e4*u)/1e4,close:Math.round(1e4*c)/1e4})}const o=new Date(s);return o.setDate(o.getDate()+r-1),console.log(`[generateMockPrices] Generated ${a.length} data points`),console.log(`[generateMockPrices] Date range: ${a[0].time} to ${a[a.length-1].time}`),console.log(`[generateMockPrices] End date: ${o.toISOString()}`),a}const se=new Date,oe=[{id:"nzdusd",symbol:"NZD/USD",name:"New Zealand Dollar / US Dollar",category:"currency",base:"NZD",quote:"USD",currentValue:.5912,previousValue:.5895,change:.0017,changePercent:.29,bid:.5911,ask:.5913,spread:2e-4,unit:"",lastUpdated:se,updateFrequency:"Real-time",data:ie(.5912,.005)},{id:"nzdaud",symbol:"NZD/AUD",name:"New Zealand Dollar / Australian Dollar",category:"currency",base:"NZD",quote:"AUD",currentValue:.9085,previousValue:.9102,change:-.0017,changePercent:-.19,bid:.9084,ask:.9086,spread:2e-4,unit:"",lastUpdated:se,updateFrequency:"Real-time",data:ie(.9085,.003)},{id:"nzdeur",symbol:"NZD/EUR",name:"New Zealand Dollar / Euro",category:"currency",base:"NZD",quote:"EUR",currentValue:.5465,previousValue:.5478,change:-.0013,changePercent:-.24,bid:.5464,ask:.5466,spread:2e-4,unit:"",lastUpdated:se,updateFrequency:"Real-time",data:ie(.5465,.004)},{id:"nzdgbp",symbol:"NZD/GBP",name:"New Zealand Dollar / British Pound",category:"currency",base:"NZD",quote:"GBP",currentValue:.4598,previousValue:.4612,change:-.0014,changePercent:-.3,bid:.4597,ask:.4599,spread:2e-4,unit:"",lastUpdated:se,updateFrequency:"Real-time",data:ie(.4598,.004)},{id:"nzdjpy",symbol:"NZD/JPY",name:"New Zealand Dollar / Japanese Yen",category:"currency",base:"NZD",quote:"JPY",currentValue:89.45,previousValue:88.92,change:.53,changePercent:.6,bid:89.44,ask:89.46,spread:.02,unit:"",lastUpdated:se,updateFrequency:"Real-time",data:ie(89.45,.008)}],le=[{id:"ocr",symbol:"OCR",name:"Official Cash Rate",category:"rate",currentValue:5.5,previousValue:5.5,change:0,changePercent:0,unit:"%",source:"Reserve Bank of New Zealand",lastUpdated:new Date("2024-02-28"),nextUpdate:new Date("2024-04-10"),updateFrequency:"Every 6 weeks",data:ie(5.5,.001)},{id:"cpi",symbol:"CPI",name:"Consumer Price Index",category:"percentage",currentValue:4.7,previousValue:5.6,change:-.9,changePercent:-16.07,unit:"% YoY",source:"Statistics New Zealand",lastUpdated:new Date("2024-01-17"),nextUpdate:new Date("2024-04-17"),updateFrequency:"Quarterly",data:ie(4.7,.02)},{id:"gdp",symbol:"GDP",name:"GDP Growth Rate",category:"percentage",currentValue:-.3,previousValue:.2,change:-.5,changePercent:-250,unit:"% QoQ",source:"Statistics New Zealand",lastUpdated:new Date("2023-12-21"),nextUpdate:new Date("2024-03-21"),updateFrequency:"Quarterly",data:ie(-.3,.05)},{id:"unemployment",symbol:"UNEMP",name:"Unemployment Rate",category:"percentage",currentValue:4,previousValue:3.9,change:.1,changePercent:2.56,unit:"%",source:"Statistics New Zealand",lastUpdated:new Date("2024-02-07"),nextUpdate:new Date("2024-05-01"),updateFrequency:"Quarterly",data:ie(4,.01)},{id:"twi",symbol:"TWI",name:"Trade Weighted Index",category:"index",currentValue:71.24,previousValue:70.89,change:.35,changePercent:.49,unit:"",source:"Reserve Bank of New Zealand",lastUpdated:se,updateFrequency:"Daily",data:ie(71.24,.01)}],ce=[...[{id:"butter-retail",symbol:"BUTTER-R",name:"Butter Retail Price",category:"commodity",commodityType:"dairy",currentValue:7.5,previousValue:7.25,change:.25,changePercent:3.45,unit:"NZ$",measureUnit:"per 500g",source:"Fonterra Co-operative Group",lastUpdated:se,updateFrequency:"Weekly",data:ie(7.5,.015)},{id:"butter-export",symbol:"BUTTER-X",name:"Butter Export Price (Fonterra Reference)",category:"commodity",commodityType:"dairy",currentValue:7821,previousValue:7650,change:171,changePercent:2.24,unit:"US$",measureUnit:"per metric tonne",source:"Fonterra / GlobalDairyTrade",grade:"Premium",lastUpdated:new Date("2024-03-12"),updateFrequency:"Bi-weekly (GDT Auction)",data:ie(7821,.025)},{id:"milk-farmgate",symbol:"MILK-FG",name:"Milk Price (Farmgate)",category:"commodity",commodityType:"dairy",currentValue:8.4,previousValue:8.2,change:.2,changePercent:2.44,unit:"NZ$",measureUnit:"per kg milk solids",source:"Fonterra",lastUpdated:new Date("2024-03-01"),updateFrequency:"Monthly",data:ie(8.4,.02)},{id:"wmp",symbol:"WMP",name:"Whole Milk Powder (Fonterra Reference)",category:"commodity",commodityType:"dairy",currentValue:4332,previousValue:4250,change:82,changePercent:1.93,unit:"US$",measureUnit:"per metric tonne",source:"Fonterra / GlobalDairyTrade",grade:"Regular",lastUpdated:new Date("2024-03-12"),updateFrequency:"Bi-weekly (GDT Auction)",data:ie(4332,.02)},{id:"smp",symbol:"SMP",name:"Skim Milk Powder (Fonterra Reference)",category:"commodity",commodityType:"dairy",currentValue:2817,previousValue:2750,change:67,changePercent:2.44,unit:"US$",measureUnit:"per metric tonne",source:"Fonterra / GlobalDairyTrade",grade:"Medium Heat",lastUpdated:new Date("2024-03-12"),updateFrequency:"Bi-weekly (GDT Auction)",data:ie(2817,.025)},{id:"amf",symbol:"AMF",name:"Anhydrous Milk Fat (Fonterra Reference)",category:"commodity",commodityType:"dairy",currentValue:7273,previousValue:7150,change:123,changePercent:1.72,unit:"US$",measureUnit:"per metric tonne",source:"Fonterra / GlobalDairyTrade",lastUpdated:new Date("2024-03-12"),updateFrequency:"Bi-weekly (GDT Auction)",data:ie(7273,.018)}],...oe,...le];function de(e,t,r=2){return"%"===t||"% YoY"===t||"% QoQ"===t?`${e.toFixed(r)}${t}`:e.toFixed(r)}function ue(){const{indicators:t,selectedId:r,categoryFilter:a,timeRange:n,addIndicator:i,updateIndicator:s,selectIndicator:o,setCategoryFilter:l,setTimeRange:M,getFilteredIndicators:E}=ne(),[R,V]=e.useState(!1),[A,T]=e.useState([]),[U,P]=e.useState(!1),[z,L]=e.useState("candlestick"),[Z,B]=e.useState(!1),[O,G]=e.useState(!0),[W,$]=e.useState(!1),[q,_]=e.useState([]);e.useEffect(()=>{try{0===t.length?(ce.forEach(i),setTimeout(()=>B(!0),100)):(t.forEach(e=>{const t=ce.find(t=>t.id===e.id);t&&s(e.id,{data:t.data})}),setTimeout(()=>B(!0),100))}catch(e){console.error("Error initializing data:",e),e instanceof DOMException&&"QuotaExceededError"===e.name&&(localStorage.removeItem("buttergoup-storage"),window.location.reload())}},[]),e.useEffect(()=>{const e=setInterval(()=>{t.forEach(e=>{if("currency"===e.category){const t=.001*(Math.random()-.5),r=e.currentValue+t;s(e.id,{currentValue:r,previousValue:e.currentValue,lastUpdated:new Date})}})},5e3);return()=>clearInterval(e)},[t,s]);const H=E(),J=t.find(e=>e.id===r);return Y.jsxs("div",{className:"app",children:[Y.jsxs("header",{children:[Y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[Y.jsx("img",{src:"/assets/logo-BnaxrZax.svg",alt:"ButterGoUp Logo",style:{height:"50px",width:"auto"}}),Y.jsxs("div",{children:[Y.jsx("h1",{children:"ButterGoUp"}),Y.jsx("p",{className:"subheader",children:"NZ Economic Eyes"})]})]}),Y.jsx(K,{})]}),Y.jsxs("main",{className:"container",children:[Y.jsxs("aside",{className:"toolbar",children:[Y.jsx("button",{className:"toolbar-button active",title:"Dashboard",children:Y.jsx(c,{size:20})}),Y.jsx("button",{className:"toolbar-button",title:"Add Indicator",children:Y.jsx(d,{size:20})}),Y.jsx("button",{className:"toolbar-button",title:"Filters",children:Y.jsx(u,{size:20})}),Y.jsx("button",{className:"toolbar-button "+(U?"active":""),title:"Chart Type",onClick:()=>P(!U),children:Y.jsx(m,{size:20})}),Y.jsx("button",{className:"toolbar-button "+(R?"active":""),title:"Technical Indicators",onClick:()=>V(!R),children:Y.jsx(p,{size:20})}),Y.jsx("button",{className:"toolbar-button "+(O?"active":""),title:"News Markers",onClick:()=>G(!O),children:Y.jsx(h,{size:20})}),Y.jsx("button",{className:"toolbar-button "+(W?"active":""),title:"Compare Series",onClick:()=>$(!W),children:Y.jsx(g,{size:20})}),Y.jsx("button",{className:"toolbar-button",title:"Alerts",children:Y.jsx(f,{size:20})}),Y.jsx("div",{className:"toolbar-divider"}),Y.jsx("button",{className:"toolbar-button",title:"Export Data",children:Y.jsx(b,{size:20})}),Y.jsx("button",{className:"toolbar-button",title:"Reports",children:Y.jsx(y,{size:20})}),Y.jsx("div",{className:"toolbar-divider"}),Y.jsx("button",{className:"toolbar-button",title:"Theme",children:Y.jsx(v,{size:20})}),Y.jsx("button",{className:"toolbar-button",title:"Settings",children:Y.jsx(x,{size:20})}),Y.jsx("div",{className:"toolbar-divider"}),Y.jsx("button",{className:"toolbar-button",title:"Reset Data",onClick:()=>{localStorage.removeItem("buttergoup-storage"),window.location.reload()},children:Y.jsx(j,{size:20})})]}),Y.jsx("section",{className:"chart-section",children:J?Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"chart-container",children:J&&J.data&&J.data.length>0?Y.jsx(Q,{data:(()=>{if(!J)return[];const e=new Date;let t=new Date;switch(n){case"1W":t.setDate(e.getDate()-7);break;case"1M":t.setMonth(e.getMonth()-1);break;case"3M":t.setMonth(e.getMonth()-3);break;case"1Y":t.setFullYear(e.getFullYear()-1);break;case"5Y":t.setFullYear(e.getFullYear()-5);break;case"10Y":t.setFullYear(e.getFullYear()-10)}return J.data.filter(e=>new Date(e.time)>=t)})(),activeIndicators:A,chartType:z,shouldFitContent:Z,setShouldFitContent:B,showNews:O,indicatorId:J.id,compareRanges:q}):Y.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#8b8b8b"},children:"Loading chart data..."})}),U&&Y.jsxs("div",{className:"chart-types-panel",children:[Y.jsx("h3",{children:"Chart Type"}),Y.jsxs("div",{className:"chart-type-options",children:[Y.jsxs("button",{className:"chart-type-option "+("candlestick"===z?"active":""),onClick:()=>{L("candlestick"),P(!1)},children:[Y.jsx(m,{size:16}),Y.jsx("span",{children:"Candlestick"})]}),Y.jsxs("button",{className:"chart-type-option "+("line"===z?"active":""),onClick:()=>{L("line"),P(!1)},children:[Y.jsx(g,{size:16}),Y.jsx("span",{children:"Line"})]}),Y.jsxs("button",{className:"chart-type-option "+("area"===z?"active":""),onClick:()=>{L("area"),P(!1)},children:[Y.jsx(w,{size:16}),Y.jsx("span",{children:"Area"})]}),Y.jsxs("button",{className:"chart-type-option "+("hlcArea"===z?"active":""),onClick:()=>{L("hlcArea"),P(!1)},children:[Y.jsx(N,{size:16}),Y.jsx("span",{children:"HLC Area"})]}),Y.jsxs("button",{className:"chart-type-option "+("columns"===z?"active":""),onClick:()=>{L("columns"),P(!1)},children:[Y.jsx(k,{size:16}),Y.jsx("span",{children:"Columns"})]}),Y.jsxs("button",{className:"chart-type-option "+("baseline"===z?"active":""),onClick:()=>{L("baseline"),P(!1)},children:[Y.jsx(S,{size:16}),Y.jsx("span",{children:"Baseline"})]})]})]}),R&&Y.jsxs("div",{className:"indicators-panel",children:[Y.jsx("h3",{children:"Technical Indicators"}),Y.jsxs("div",{className:"indicator-options",children:[Y.jsxs("label",{className:"indicator-option",children:[Y.jsx("input",{type:"checkbox",checked:A.includes("bollinger"),onChange:e=>{e.target.checked?T([...A,"bollinger"]):T(A.filter(e=>"bollinger"!==e))}}),Y.jsx("span",{children:"Bollinger Bands"})]}),Y.jsxs("label",{className:"indicator-option",children:[Y.jsx("input",{type:"checkbox",checked:A.includes("sma20"),onChange:e=>{e.target.checked?T([...A,"sma20"]):T(A.filter(e=>"sma20"!==e))}}),Y.jsx("span",{children:"SMA (20)"})]}),Y.jsxs("label",{className:"indicator-option",children:[Y.jsx("input",{type:"checkbox",checked:A.includes("sma50"),onChange:e=>{e.target.checked?T([...A,"sma50"]):T(A.filter(e=>"sma50"!==e))}}),Y.jsx("span",{children:"SMA (50)"})]}),Y.jsxs("label",{className:"indicator-option",children:[Y.jsx("input",{type:"checkbox",checked:A.includes("ema12"),onChange:e=>{e.target.checked?T([...A,"ema12"]):T(A.filter(e=>"ema12"!==e))}}),Y.jsx("span",{children:"EMA (12)"})]}),Y.jsxs("label",{className:"indicator-option",children:[Y.jsx("input",{type:"checkbox",checked:A.includes("ema26"),onChange:e=>{e.target.checked?T([...A,"ema26"]):T(A.filter(e=>"ema26"!==e))}}),Y.jsx("span",{children:"EMA (26)"})]}),Y.jsxs("label",{className:"indicator-option",children:[Y.jsx("input",{type:"checkbox",checked:A.includes("stddev"),onChange:e=>{e.target.checked?T([...A,"stddev"]):T(A.filter(e=>"stddev"!==e))}}),Y.jsx("span",{children:"Std Dev Channels"})]}),Y.jsxs("label",{className:"indicator-option",children:[Y.jsx("input",{type:"checkbox",checked:A.includes("bbpercent"),onChange:e=>{e.target.checked?T([...A,"bbpercent"]):T(A.filter(e=>"bbpercent"!==e))}}),Y.jsx("span",{children:"BB %ile"})]})]})]}),W&&Y.jsxs("div",{className:"compare-panel",children:[Y.jsx("h3",{children:"Compare Series"}),Y.jsxs("div",{className:"compare-options",children:[Y.jsxs("label",{className:"compare-option",children:[Y.jsx("input",{type:"checkbox",checked:q.includes("1Y"),onChange:e=>{e.target.checked?_([...q,"1Y"]):_(q.filter(e=>"1Y"!==e))}}),Y.jsx("span",{children:"1 Year Ago"})]}),Y.jsxs("label",{className:"compare-option",children:[Y.jsx("input",{type:"checkbox",checked:q.includes("2Y"),onChange:e=>{e.target.checked?_([...q,"2Y"]):_(q.filter(e=>"2Y"!==e))}}),Y.jsx("span",{children:"2 Years Ago"})]}),Y.jsxs("label",{className:"compare-option",children:[Y.jsx("input",{type:"checkbox",checked:q.includes("3Y"),onChange:e=>{e.target.checked?_([...q,"3Y"]):_(q.filter(e=>"3Y"!==e))}}),Y.jsx("span",{children:"3 Years Ago"})]}),Y.jsxs("label",{className:"compare-option",children:[Y.jsx("input",{type:"checkbox",checked:q.includes("5Y"),onChange:e=>{e.target.checked?_([...q,"5Y"]):_(q.filter(e=>"5Y"!==e))}}),Y.jsx("span",{children:"5 Years Ago"})]}),Y.jsxs("label",{className:"compare-option",children:[Y.jsx("input",{type:"checkbox",checked:q.includes("AVG"),onChange:e=>{e.target.checked?_([...q,"AVG"]):_(q.filter(e=>"AVG"!==e))}}),Y.jsx("span",{children:"Historical Average"})]})]}),Y.jsxs("div",{className:"compare-legend",children:[q.includes("1Y")&&Y.jsxs("div",{className:"legend-item",children:[Y.jsx("div",{className:"legend-line",style:{backgroundColor:"#f59e0b"}}),Y.jsx("span",{children:"1 Year Ago"})]}),q.includes("2Y")&&Y.jsxs("div",{className:"legend-item",children:[Y.jsx("div",{className:"legend-line",style:{backgroundColor:"#3b82f6"}}),Y.jsx("span",{children:"2 Years Ago"})]}),q.includes("3Y")&&Y.jsxs("div",{className:"legend-item",children:[Y.jsx("div",{className:"legend-line",style:{backgroundColor:"#a855f7"}}),Y.jsx("span",{children:"3 Years Ago"})]}),q.includes("5Y")&&Y.jsxs("div",{className:"legend-item",children:[Y.jsx("div",{className:"legend-line",style:{backgroundColor:"#ec4899"}}),Y.jsx("span",{children:"5 Years Ago"})]}),q.includes("AVG")&&Y.jsxs("div",{className:"legend-item",children:[Y.jsx("div",{className:"legend-line",style:{backgroundColor:"#6b7280",borderStyle:"dashed"}}),Y.jsx("span",{children:"Historical Avg"})]})]})]}),Y.jsx("div",{className:"chart-header",children:Y.jsxs("div",{children:[Y.jsxs("h2",{children:[J.symbol," - ",J.name,"commodity"===J.category&&"measureUnit"in J&&Y.jsxs("span",{className:"measure-unit",children:[" (",J.measureUnit,")"]})]}),"source"in J&&Y.jsxs("p",{className:"data-source",children:["Source: ",J.source]})]})}),Y.jsxs("div",{className:"price-info",children:[Y.jsxs("div",{className:"current-value",children:[Y.jsx("span",{className:"value-label",children:"Current"}),Y.jsxs("span",{className:"value",children:["currency"===J.category||"%"===J.unit?"":J.unit,de(J.currentValue,J.unit,"currency"===J.category?4:2)]}),Y.jsxs("span",{className:"value-change "+(J.change>=0?"positive":"negative"),children:[J.change>=0?Y.jsx(g,{size:20,style:{display:"inline",marginRight:"0.5rem"}}):Y.jsx(D,{size:20,style:{display:"inline",marginRight:"0.5rem"}}),J.change>=0?"+":"",J.change.toFixed("currency"===J.category?4:2),"(",J.changePercent>=0?"+":"",J.changePercent.toFixed(2),"%)"]})]}),"currency"===J.category&&"bid"in J&&Y.jsxs("div",{className:"bid-ask-spread",children:[Y.jsxs("div",{children:[Y.jsx("span",{className:"label",children:"Bid"}),Y.jsx("span",{className:"value",children:J.bid?.toFixed(4)})]}),Y.jsxs("div",{children:[Y.jsx("span",{className:"label",children:"Ask"}),Y.jsx("span",{className:"value",children:J.ask?.toFixed(4)})]}),Y.jsxs("div",{children:[Y.jsx("span",{className:"label",children:"Spread"}),Y.jsx("span",{className:"value",children:J.spread?.toFixed(4)})]})]}),"nextUpdate"in J&&J.nextUpdate&&Y.jsxs("div",{className:"next-update",children:["Next update: ",(()=>{const e=J.nextUpdate;return e?("string"==typeof e?new Date(e):e).toLocaleDateString("en-NZ"):""})()]})]}),Y.jsx("div",{className:"time-range-overlay",children:Y.jsx("div",{className:"time-range-selector",children:["1W","1M","3M","1Y","5Y","10Y"].map(e=>Y.jsx("button",{className:"time-range-btn "+(n===e?"active":""),onClick:()=>{M(e),B(!0)},children:e},e))})})]}):Y.jsx("div",{className:"empty-state",children:"Select an indicator to view chart"})}),Y.jsxs("aside",{className:"sidebar",children:[Y.jsxs("div",{className:"indicator-panel",children:[Y.jsx("div",{className:"filter-section",children:Y.jsx("select",{value:a,onChange:e=>l(e.target.value),className:"category-filter",children:[{value:"all",label:"All Indicators"},{value:"currency",label:"Currencies"},{value:"rate",label:"Interest Rates"},{value:"index",label:"Indices"},{value:"percentage",label:"Economic Data"},{value:"commodity",label:"Commodities"}].map(e=>Y.jsx("option",{value:e.value,children:e.label},e.value))})}),Y.jsx("div",{className:"indicator-list",children:H.map((e,t)=>{const a="currency"===e.category,n="commodity"===e.category;return Y.jsxs("div",{className:"indicator-item "+(r===e.id?"active":""),onClick:()=>{o(e.id),B(!0)},children:[Y.jsxs("div",{className:"indicator-left",children:[Y.jsxs("div",{className:"indicator-header",children:[Y.jsx("span",{className:"indicator-icon",children:(()=>{switch(e.category){case"currency":return Y.jsx(F,{size:16});case"rate":return Y.jsx(I,{size:16});case"index":return Y.jsx(N,{size:16});case"percentage":return Y.jsx(S,{size:16});case"commodity":return Y.jsx(C,{size:16});default:return null}})()}),Y.jsx("strong",{children:e.symbol})]}),Y.jsxs("div",{className:"indicator-name",children:[e.name,n&&"measureUnit"in e&&Y.jsxs("span",{className:"measure-unit",children:[" (",e.measureUnit,")"]})]})]}),Y.jsxs("div",{className:"indicator-right",children:[Y.jsx("div",{className:"indicator-value",children:Y.jsxs("strong",{children:[a||"%"===e.unit?"":e.unit,de(e.currentValue,e.unit,a?4:2)]})}),Y.jsxs("div",{className:"indicator-change "+(e.change>=0?"positive":"negative"),children:[e.change>=0?"+":"",e.changePercent.toFixed(2),"%"]})]})]},`${e.id}-${t}`)})})]}),Y.jsxs("div",{className:"info-panel",children:[Y.jsx("h3",{children:"Market Information"}),J?Y.jsxs("div",{className:"info-content",children:[Y.jsxs("div",{className:"info-section",children:[Y.jsx("h4",{children:"Performance"}),Y.jsx("div",{className:"performance-cards",children:[{label:"1 Week",range:5},{label:"1 Month",range:10},{label:"3 Months",range:15},{label:"1 Year",range:25}].map(({label:e,range:t})=>{const r=Math.random()>.5,a=(Math.random()*t).toFixed(2);return Y.jsxs("div",{className:"perf-card",style:{background:r?"linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(34, 197, 94, 0.05) 100%)":"linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.05) 100%)",border:"1px solid "+(r?"rgba(34, 197, 94, 0.2)":"rgba(239, 68, 68, 0.2)")},children:[Y.jsx("span",{className:"perf-label",children:e}),Y.jsxs("span",{className:"perf-value "+(r?"positive":"negative"),children:[r?"+":"-",a,"%"]})]},e)})})]}),Y.jsxs("div",{className:"info-section",children:[Y.jsx("h4",{children:"Seasonal Trends"}),Y.jsxs("div",{className:"seasonal-chart",children:[Y.jsxs("svg",{viewBox:"0 0 300 80",className:"seasonal-svg",children:[[0,25,50,75,100].map(e=>Y.jsx("line",{x1:"0",y1:80-.8*e,x2:"300",y2:80-.8*e,stroke:"rgba(255,255,255,0.05)",strokeWidth:"1"},e)),[{year:"2024",color:"#3ecf8e",offset:0},{year:"2023",color:"#f59e0b",offset:5},{year:"2022",color:"#3b82f6",offset:-5},{year:"2021",color:"#a855f7",offset:10}].map(({year:e,color:t,offset:r})=>{const a=Array.from({length:12},(e,t)=>`${t/11*280+10},${80-.8*(25*Math.sin(t/12*Math.PI*2)+50+r+(10*Math.random()-5))}`).join(" ");return Y.jsxs("g",{children:[Y.jsx("polyline",{points:a,fill:"none",stroke:t,strokeWidth:"2",strokeLinejoin:"round",strokeLinecap:"round",opacity:"0.8"}),Y.jsx("polyline",{points:a,fill:"none",stroke:t,strokeWidth:"4",strokeLinejoin:"round",strokeLinecap:"round",opacity:"0.3",filter:"blur(4px)"})]},e)}),["J","F","M","A","M","J","J","A","S","O","N","D"].map((e,t)=>Y.jsx("text",{x:t/11*280+10,y:"78",fontSize:"9",fill:"var(--text-secondary)",textAnchor:"middle",children:e},e))]}),Y.jsx("div",{className:"seasonal-legend",children:[{year:"2024",color:"#3ecf8e"},{year:"2023",color:"#f59e0b"},{year:"2022",color:"#3b82f6"},{year:"2021",color:"#a855f7"}].map(({year:e,color:t})=>Y.jsxs("div",{className:"legend-item",children:[Y.jsx("div",{className:"legend-dot",style:{backgroundColor:t}}),Y.jsx("span",{className:"legend-label",children:e})]},e))})]})]}),Y.jsxs("div",{className:"info-section",children:[Y.jsx("h4",{children:"Technical Details"}),Y.jsxs("div",{className:"info-details",children:[Y.jsxs("div",{className:"info-detail",children:[Y.jsx("span",{className:"info-label",children:"52W High"}),Y.jsx("span",{className:"info-value",children:(1.15*J.currentValue).toFixed("currency"===J.category?4:2)})]}),Y.jsxs("div",{className:"info-detail",children:[Y.jsx("span",{className:"info-label",children:"52W Low"}),Y.jsx("span",{className:"info-value",children:(.85*J.currentValue).toFixed("currency"===J.category?4:2)})]}),Y.jsxs("div",{className:"info-detail",children:[Y.jsx("span",{className:"info-label",children:"Volatility"}),Y.jsxs("span",{className:"info-value",children:[(30*Math.random()+10).toFixed(1),"%"]})]}),Y.jsxs("div",{className:"info-detail",children:[Y.jsx("span",{className:"info-label",children:"Update Freq"}),Y.jsx("span",{className:"info-value",children:J.updateFrequency})]}),"source"in J&&Y.jsxs("div",{className:"info-detail",children:[Y.jsx("span",{className:"info-label",children:"Source"}),Y.jsx("span",{className:"info-value",children:J.source})]})]})]})]}):Y.jsx("div",{className:"info-placeholder",children:Y.jsx("p",{children:"Select an indicator to view detailed information"})})]})]})]})]})}L(document.getElementById("root")).render(Y.jsx(e.StrictMode,{children:Y.jsx(ue,{})}));
